import sane_tikz as stz
import math


def combine_tikz_strs(lst):
    return ", ".join(lst)


def line_width(width_in_cm):
    return "line width=%fcm" % width_in_cm


def fill_color(color_name):
    return "fill=%s" % color_name


def line_and_fill_colors(line_color_name, fill_color_name):
    return combine_tikz_strs([fill_color(color_name), no_line()])


def fill_color_with_no_line(color_name):
    return combine_tikz_strs([fill_color(color_name), no_line()])


def text_color(color_name):
    return "text=%s" % color_name

def color(color_name):
    return "color=%s" % color_name


def rounded_corners(radius_in_cm):
    return "rounded corners=%fcm" % radius_in_cm


def line_color(color_name):
    return "color=%s" % color_name


def no_line():
    return "draw=none"


def no_fill():
    return "fill=none"


def line_and_fill_colors(line_color_name, fill_color_name):
    return combine_tikz_strs(
        [line_color(line_color_name),
         fill_color(fill_color_name)])


def fill_opacity(alpha):
    return "fill opacity=%f" % alpha


def line_opacity(alpha):
    return "line opacity=%f" % alpha


def opacity(alpha):
    return combine_tikz_strs([fill_opacity(alpha), line_opacity(alpha)])


def line_style(s):
    assert s == "dashed" or s == "dotted" or s == "solid"
    return s


def arrow_heads(s):
    if s == 'both':
        return "latex-latex"
    elif s == "start":
        return "latex-"
    elif s == "end":
        return "-latex"
    else:
        raise ValueError


def text_width(width_in_cm):
    return "text width=%fcm" % width_in_cm


def orientation(angle):
    return "rotation=%f" % angle


# NOTE: this functionality is not complete as I haven't tried yet.
def alignment(s):
    assert s == "center" or s == "left" or s == "right"
    return "align=%s" % s


# NOTE:
def erase():
    pass


standard_line_width = 1.0 / 64

#===> Colors
google_slides_colors = {
    # row 1
    "black": (0, 0, 0),
    "dark_grey_4": (67, 67, 67),
    "dark_grey_3": (102, 102, 102),
    "dark_grey_2": (153, 153, 153),
    "grey": (183, 183, 183),
    "light_grey_1": (204, 204, 204),
    "light_grey_2": (217, 217, 217),
    "light_grey_3": (239, 239, 239),
    "white": (255, 255, 255),
    # row 2
    "red_berry": (151, 3, 0),
    "red": (245, 8, 2),
    "orange": (247, 153, 4),
    "yellow": (253, 255, 1),
    "green": (74, 255, 0),
    "cyan": (83, 255, 255),
    "cornflower_blue": (74, 134, 232),
    "blue": (38, 1, 255),
    "purple": (153, 1, 254),
    "magenta": (247, 0, 255),
    # row 3
    "light_red_berry_3": (230, 184, 175),
    "light_red_3": (244, 204, 205),
    "light_orange_3": (252, 229, 205),
    "light_yellow_3": (253, 242, 204),
    "light_green_3": (217, 234, 211),
    "light_cyan_3": (208, 224, 228),
    "light_cornflower_blue_3": (202, 218, 248),
    "light_blue_3": (208, 226, 243),
    "light_purple_3": (217, 210, 233),
    "light_magenta_3": (234, 209, 220),
    # row 4
    "light_red_berry_2": (221, 125, 106),
    "light_red_2": (234, 153, 153),
    "light_orange_2": (249, 203, 156),
    "light_yellow_2": (252, 230, 153),
    "light_green_2": (182, 215, 168),
    "light_cyan_2": (162, 196, 201),
    "light_cornflower_blue_2": (164, 194, 244),
    "light_blue_2": (159, 197, 232),
    "light_purple_2": (180, 167, 214),
    "light_magenta_2": (213, 166, 189),
    # row 5
    "light_red_berry_1": (204, 65, 37),
    "light_red_1": (224, 101, 102),
    "light_orange_1": (246, 179, 107),
    "light_yellow_1": (251, 218, 101),
    "light_green_1": (147, 196, 124),
    "light_cyan_1": (118, 165, 175),
    "light_cornflower_blue_1": (109, 157, 235),
    "light_blue_1": (111, 168, 220),
    "light_purple_1": (142, 123, 195),
    "light_magenta_1": (194, 123, 160),
    # row 6
    "dark_red_berry_1": (166, 28, 0),
    "dark_red_1": (205, 5, 0),
    "dark_orange_1": (230, 144, 56),
    "dark_yellow_1": (241, 194, 51),
    "dark_green_1": (106, 168, 78),
    "dark_cyan_1": (69, 129, 142),
    "dark_cornflower_blue_1": (60, 120, 216),
    "dark_blue_1": (61, 132, 198),
    "dark_purple_1": (103, 77, 167),
    "dark_magenta_1": (166, 77, 120),
    # row 7
    "dark_red_berry_2": (132, 33, 11),
    "dark_red_2": (153, 3, 0),
    "dark_orange_2": (180, 94, 6),
    "dark_yellow_2": (191, 144, 0),
    "dark_green_2": (56, 118, 29),
    "dark_cyan_2": (21, 79, 92),
    "dark_cornflower_blue_2": (36, 85, 204),
    "dark_blue_2": (28, 82, 148),
    "dark_purple_2": (53, 29, 116),
    "dark_magenta_2": (115, 27, 70),
    # row 8
    "dark_red_berry_3": (91, 15, 0),
    "dark_red_3": (101, 1, 0),
    "dark_orange_3": (120, 63, 4),
    "dark_yellow_3": (127, 96, 0),
    "dark_green_3": (39, 78, 18),
    "dark_cyan_3": (12, 52, 61),
    "dark_cornflower_blue_3": (28, 68, 134),
    "dark_blue_3": (15, 55, 99),
    "dark_purple_3": (32, 18, 77),
    "dark_magenta_3": (76, 16, 48),
}

# https://seaborn.pydata.org/tutorial/color_palettes.html
seaborn_colors = [
    (76, 113, 176),
    (221, 131, 82),
    (85, 168, 103),
    (129, 113, 179),
    (147, 120, 96),
    (218, 139, 195),
    (140, 140, 140),
    (205, 185, 115),
    (100, 181, 205),
]


def shade_color(rgb, alpha):
    return tuple([int(round((1.0 - alpha) * x, 0)) for x in rgb])


def tint_color(rgb, alpha):
    return tuple(
        [int(round(255.0 * alpha + (1.0 - alpha) * x, 0)) for x in rgb])


# TODO: get the color maps with 255 colors.

viridis_colormap = [
    (72, 0, 84),
    (73, 0, 86),
    (73, 0, 87),
    (74, 0, 89),
    (74, 1, 90),
    (74, 2, 92),
    (75, 3, 93),
    (75, 5, 95),
    (76, 7, 96),
    (76, 8, 98),
    (76, 10, 99),
    (77, 12, 100),
    (77, 13, 102),
    (77, 15, 103),
    (78, 17, 104),
    (78, 18, 106),
    (78, 20, 107),
    (78, 21, 108),
    (79, 23, 109),
    (79, 24, 110),
    (79, 26, 112),
    (79, 27, 113),
    (79, 28, 114),
    (79, 30, 115),
    (80, 31, 116),
    (80, 33, 117),
    (80, 34, 118),
    (80, 35, 119),
    (80, 37, 120),
    (80, 38, 121),
    (80, 39, 122),
    (80, 41, 123),
    (80, 42, 124),
    (80, 43, 125),
    (80, 44, 125),
    (79, 46, 126),
    (79, 47, 127),
    (79, 48, 128),
    (79, 50, 128),
    (79, 51, 129),
    (79, 52, 130),
    (79, 53, 130),
    (78, 55, 131),
    (78, 56, 132),
    (78, 57, 132),
    (78, 58, 133),
    (77, 60, 133),
    (77, 61, 134),
    (77, 62, 134),
    (76, 63, 135),
    (76, 65, 135),
    (76, 66, 136),
    (75, 67, 136),
    (75, 68, 136),
    (75, 69, 137),
    (74, 71, 137),
    (74, 72, 137),
    (74, 73, 138),
    (73, 74, 138),
    (73, 75, 138),
    (73, 76, 139),
    (72, 77, 139),
    (72, 79, 139),
    (71, 80, 139),
    (71, 81, 140),
    (70, 82, 140),
    (70, 83, 140),
    (70, 84, 140),
    (69, 85, 140),
    (69, 86, 140),
    (68, 87, 141),
    (68, 89, 141),
    (68, 90, 141),
    (67, 91, 141),
    (67, 92, 141),
    (66, 93, 141),
    (66, 94, 141),
    (65, 95, 141),
    (65, 96, 142),
    (65, 97, 142),
    (64, 98, 142),
    (64, 99, 142),
    (63, 100, 142),
    (63, 101, 142),
    (62, 102, 142),
    (62, 103, 142),
    (62, 104, 142),
    (61, 105, 142),
    (61, 106, 142),
    (60, 107, 142),
    (60, 108, 142),
    (60, 109, 142),
    (59, 110, 142),
    (59, 111, 142),
    (58, 112, 142),
    (58, 113, 142),
    (57, 114, 142),
    (57, 115, 142),
    (57, 116, 142),
    (56, 117, 142),
    (56, 118, 142),
    (55, 119, 142),
    (55, 120, 142),
    (55, 121, 142),
    (54, 122, 142),
    (54, 123, 142),
    (53, 124, 142),
    (53, 125, 142),
    (52, 126, 142),
    (52, 127, 142),
    (51, 127, 142),
    (51, 128, 142),
    (51, 129, 142),
    (50, 130, 142),
    (50, 131, 142),
    (49, 132, 142),
    (49, 133, 142),
    (48, 134, 142),
    (48, 135, 142),
    (47, 136, 142),
    (47, 137, 141),
    (46, 138, 141),
    (46, 139, 141),
    (45, 140, 141),
    (45, 141, 141),
    (44, 142, 141),
    (44, 143, 141),
    (43, 144, 140),
    (42, 145, 140),
    (42, 146, 140),
    (41, 147, 140),
    (41, 148, 140),
    (40, 149, 139),
    (40, 150, 139),
    (39, 150, 139),
    (39, 151, 139),
    (38, 152, 138),
    (38, 153, 138),
    (37, 154, 138),
    (37, 155, 137),
    (36, 156, 137),
    (36, 157, 137),
    (35, 158, 136),
    (35, 159, 136),
    (34, 160, 136),
    (34, 161, 135),
    (34, 162, 135),
    (33, 163, 134),
    (33, 164, 134),
    (33, 165, 133),
    (32, 166, 133),
    (32, 167, 132),
    (32, 168, 132),
    (32, 169, 131),
    (32, 170, 131),
    (32, 170, 130),
    (32, 171, 130),
    (33, 172, 129),
    (33, 173, 129),
    (33, 174, 128),
    (34, 175, 127),
    (34, 176, 127),
    (35, 177, 126),
    (36, 178, 125),
    (36, 179, 124),
    (37, 180, 124),
    (38, 181, 123),
    (39, 182, 122),
    (40, 182, 121),
    (41, 183, 120),
    (42, 184, 120),
    (44, 185, 119),
    (45, 186, 118),
    (46, 187, 117),
    (48, 188, 116),
    (49, 189, 115),
    (51, 189, 114),
    (52, 190, 113),
    (54, 191, 112),
    (56, 192, 111),
    (58, 193, 110),
    (59, 194, 109),
    (61, 195, 108),
    (63, 195, 107),
    (65, 196, 106),
    (67, 197, 104),
    (69, 198, 103),
    (71, 199, 102),
    (73, 199, 101),
    (75, 200, 100),
    (77, 201, 98),
    (79, 202, 97),
    (81, 202, 96),
    (84, 203, 94),
    (86, 204, 93),
    (88, 205, 92),
    (90, 205, 90),
    (93, 206, 89),
    (95, 207, 87),
    (97, 208, 86),
    (100, 208, 84),
    (102, 209, 83),
    (104, 210, 81),
    (107, 210, 80),
    (109, 211, 78),
    (112, 212, 77),
    (114, 212, 75),
    (117, 213, 73),
    (119, 213, 72),
    (122, 214, 70),
    (124, 215, 68),
    (127, 215, 67),
    (130, 216, 65),
    (132, 216, 63),
    (135, 217, 61),
    (137, 217, 60),
    (140, 218, 58),
    (143, 219, 56),
    (145, 219, 54),
    (148, 220, 52),
    (151, 220, 50),
    (153, 220, 48),
    (156, 221, 46),
    (159, 221, 44),
    (161, 222, 42),
    (164, 222, 40),
    (167, 223, 38),
    (170, 223, 36),
    (172, 224, 34),
    (175, 224, 32),
    (178, 224, 30),
    (181, 225, 28),
    (183, 225, 26),
    (186, 226, 23),
    (189, 226, 21),
    (191, 226, 19),
    (194, 227, 17),
    (197, 227, 15),
    (199, 227, 14),
    (202, 228, 12),
    (205, 228, 11),
    (207, 228, 10),
    (210, 229, 9),
    (213, 229, 9),
    (215, 229, 9),
    (218, 230, 9),
    (221, 230, 10),
    (223, 230, 11),
    (226, 230, 13),
    (228, 231, 15),
    (231, 231, 17),
    (233, 231, 19),
    (236, 232, 21),
    (238, 232, 24),
    (241, 232, 26),
    (243, 233, 28),
]
